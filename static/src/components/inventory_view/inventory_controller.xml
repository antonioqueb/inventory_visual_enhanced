<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">
    
    <t t-name="inventory_visual_enhanced.InventoryView" owl="1">
        <div class="o_inventory_visual_container d-flex flex-column vh-100">
            
            <!-- Barra de filtros superior -->
            <SearchBar 
                isLoading="state.isLoading"
                onSearch.bind="onSearch"
                totalProducts="state.totalProducts"
                hasSearched="state.hasSearched"
            />
            
            <!-- Contenido principal -->
            <div class="o_inventory_visual_content flex-grow-1 overflow-auto">
                
                <!-- Estado inicial -->
                <div class="o_inventory_visual_empty" t-if="!state.hasSearched and !state.isLoading">
                    <i class="fa fa-filter empty-icon"></i>
                    <h2 class="empty-title">Aplica filtros para visualizar tu inventario</h2>
                    <p class="empty-subtitle">
                        Selecciona uno o más filtros en la barra superior
                        para ver el inventario agrupado con métricas detalladas.
                    </p>
                </div>
                
                <!-- Loading -->
                <div class="o_inventory_loading" t-if="state.isLoading">
                    <div class="spinner"></div>
                    <div class="loading-text">Cargando inventario...</div>
                </div>
                
                <!-- Error -->
                <div class="o_inventory_error" t-if="state.error">
                    <i class="fa fa-exclamation-triangle error-icon"></i>
                    <div class="error-message" t-esc="state.error"></div>
                </div>
                
                <!-- Sin resultados -->
                <div class="o_inventory_no_results" t-if="state.hasSearched and state.products.length === 0 and !state.isLoading">
                    <i class="fa fa-inbox no-results-icon"></i>
                    <h3 class="no-results-title">No se encontraron productos</h3>
                    <p class="no-results-message">
                        Intenta con otros filtros o verifica el inventario disponible.
                    </p>
                </div>
                
                <!-- DATA GRID -->
                <div class="o_inventory_data_grid" t-if="state.products.length > 0 and !state.isLoading">
                    <table class="o_inventory_grid_table">
                        <thead>
                            <tr>
                                <th class="col-product-name">Product Name (SKU)</th>
                                <th class="col-inventory">Inventory</th>
                                <th class="col-type">Type</th>
                                <th class="col-category">Category</th>
                                <!-- Columna Actions eliminada -->
                            </tr>
                        </thead>
                        <tbody>
                            <t t-foreach="state.products" t-as="product" t-key="product.product_id">
                                <ProductRow 
                                    product="product"
                                    isExpanded="isProductExpanded(product.product_id)"
                                    details="getProductDetails(product.product_id)"
                                    onToggle.bind="(quantIds) => this.toggleProduct(product.product_id, quantIds)"
                                    onPhotoClick.bind="onPhotoClick"
                                    onNotesClick.bind="onNotesClick"
                                    onDetailsClick.bind="onDetailsClick"
                                    onSalesPersonClick.bind="onSalesPersonClick"
                                    onHoldClick.bind="onHoldClick"
                                    onSaleOrderClick.bind="onSaleOrderClick"
                                    formatNumber.bind="formatNumber"
                                    hasSalesPermissions="state.hasSalesPermissions"
                                    hasInventoryPermissions="state.hasInventoryPermissions"
                                    isInCart.bind="isInCart"
                                    toggleCartSelection.bind="toggleCartSelection"
                                    areAllCurrentProductSelected.bind="() => this.areAllCurrentProductSelected()"
                                    selectAllCurrentProduct.bind="() => this.selectAllCurrentProduct()"
                                    deselectAllCurrentProduct.bind="() => this.deselectAllCurrentProduct()"
                                />
                            </t>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </t>
    
</templates>